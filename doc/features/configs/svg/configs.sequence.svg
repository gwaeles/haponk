<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1501px" preserveAspectRatio="none" style="width:552px;height:1501px;background:#FFFFFF;" version="1.1" viewBox="0 0 552 1501" width="552px" zoomAndPan="magnify"><defs/><g><rect fill="#90CAF9" height="1482.1563" style="stroke:#181818;stroke-width:0.5;" width="100" x="8" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="85" x="15.5" y="18.5684">Presentation</text><rect fill="#BBDEFB" height="1482.1563" style="stroke:#181818;stroke-width:0.5;" width="96" x="111" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="90" x="114" y="18.5684">Domain layer</text><rect fill="#E3F2FD" height="1482.1563" style="stroke:#181818;stroke-width:0.5;" width="335" x="209" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="69" x="342" y="18.5684">Data layer</text><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="278" y="317.6621"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="407" y="346.9727"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="500.5" y="1334.3574"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="58" x2="58" y1="87.7988" y2="1422.668"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="159" x2="159" y1="87.7988" y2="1422.668"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="283" x2="283" y1="87.7988" y2="1422.668"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="412" x2="412" y1="87.7988" y2="1422.668"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="505" x2="505" y1="87.7988" y2="1422.668"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92" x="12" y="56.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="19" y="76.8457">Application</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92" x="12" y="1421.668"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="19" y="1442.2031">Application</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="115" y="56.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="122" y="76.8457">ConfigBloc</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="115" y="1421.668"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="122" y="1442.2031">ConfigBloc</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="213" y="56.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="220" y="76.8457">ConfigsRepository</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="213" y="1421.668"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="220" y="1442.2031">ConfigsRepository</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="363" y="84.8457">Local Storage</text><path d="M394,35.3105 C394,25.3105 412,25.3105 412,25.3105 C412,25.3105 430,25.3105 430,35.3105 L430,61.3105 C430,71.3105 412,71.3105 412,71.3105 C412,71.3105 394,71.3105 394,61.3105 L394,35.3105 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M394,35.3105 C394,45.3105 412,45.3105 412,45.3105 C412,45.3105 430,45.3105 430,35.3105 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="363" y="1435.2031">Local Storage</text><path d="M394,1448.1563 C394,1438.1563 412,1438.1563 412,1438.1563 C412,1438.1563 430,1438.1563 430,1448.1563 L430,1474.1563 C430,1484.1563 412,1484.1563 412,1484.1563 C412,1484.1563 394,1484.1563 394,1474.1563 L394,1448.1563 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M394,1448.1563 C394,1458.1563 412,1458.1563 412,1458.1563 C412,1458.1563 430,1458.1563 430,1448.1563 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="471" y="56.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="478" y="76.8457">HassApi</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="69" x="471" y="1421.668"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="478" y="1442.2031">HassApi</text><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="278" y="317.6621"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="407" y="346.9727"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="500.5" y="1334.3574"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="545" x="0" y="118.4541"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="545" y1="118.4541" y2="118.4541"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="545" y1="121.4541" y2="121.4541"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="118" x="213.5" y="107.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="100" x="219.5" y="124.3672">On app launch</text><path d="M5,146.1094 L5,171.1094 L112,171.1094 L112,156.1094 L102,146.1094 L5,146.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M102,146.1094 L102,156.1094 L112,156.1094 L102,146.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="11" y="163.6777">LauncherPage</text><path d="M141,181.4199 L141,206.4199 L177,206.4199 L177,191.4199 L167,181.4199 L141,181.4199 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,181.4199 L167,191.4199 L177,191.4199 L167,181.4199 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="198.9883">S1</text><polygon fill="#181818" points="147,213.7305,157,217.7305,147,221.7305,151,217.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58" x2="153" y1="217.7305" y2="217.7305"/><path d="M141,230.7305 L141,255.7305 L177,255.7305 L177,240.7305 L167,230.7305 L141,230.7305 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,230.7305 L167,240.7305 L177,240.7305 L167,230.7305 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="248.2988">E1</text><path d="M141,266.041 L141,291.041 L177,291.041 L177,276.041 L167,266.041 L141,266.041 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,266.041 L167,276.041 L177,276.041 L167,266.041 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="283.6094">S2</text><polygon fill="#181818" points="266,313.6621,276,317.6621,266,321.6621,270,317.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="272" y1="317.6621" y2="317.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="166" y="312.9199">getLastConfig()</text><polygon fill="#181818" points="395,342.9727,405,346.9727,395,350.9727,399,346.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="288" x2="401" y1="346.9727" y2="346.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="295" y="342.2305">box.get()</text><polygon fill="#181818" points="299,372.2832,289,376.2832,299,380.2832,295,376.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="293" x2="411" y1="376.2832" y2="376.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="305" y="371.541">Config</text><polygon fill="#181818" points="170,401.5938,160,405.5938,170,409.5938,166,405.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="164" x2="282" y1="405.5938" y2="405.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="176" y="400.8516">Config</text><path d="M141,418.5938 L141,443.5938 L177,443.5938 L177,428.5938 L167,418.5938 L141,418.5938 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,418.5938 L167,428.5938 L177,428.5938 L167,418.5938 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="436.1621">S3</text><polygon fill="#181818" points="170,466.2148,160,470.2148,170,474.2148,166,470.2148" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164" x2="282" y1="470.2148" y2="470.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="176" y="465.4727">onError()</text><path d="M141,483.2148 L141,508.2148 L177,508.2148 L177,493.2148 L167,483.2148 L141,483.2148 " fill="#FFAAAA" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,483.2148 L167,493.2148 L177,493.2148 L167,483.2148 " fill="#FFAAAA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="500.7832">S6</text><polygon fill="#181818" points="69,515.5254,59,519.5254,69,523.5254,65,519.5254" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="63" x2="158" y1="519.5254" y2="519.5254"/><line style="stroke:#181818;stroke-width:1.0;" x1="58" x2="100" y1="533.5254" y2="533.5254"/><line style="stroke:#181818;stroke-width:1.0;" x1="100" x2="100" y1="533.5254" y2="546.5254"/><line style="stroke:#181818;stroke-width:1.0;" x1="59" x2="100" y1="546.5254" y2="546.5254"/><polygon fill="#181818" points="69,542.5254,59,546.5254,69,550.5254,65,546.5254" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="545" x="0" y="575.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="545" y1="575.1807" y2="575.1807"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="545" y1="578.1807" y2="578.1807"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2.0;" width="228" x="158.5" y="564.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="210" x="164.5" y="581.0938">New or never connected config</text><path d="M17,602.8359 L17,627.8359 L99,627.8359 L99,612.8359 L89,602.8359 L17,602.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M89,602.8359 L89,612.8359 L99,612.8359 L89,602.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="23" y="620.4043">FormPage</text><path d="M141,638.1465 L141,663.1465 L177,663.1465 L177,648.1465 L167,638.1465 L141,638.1465 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,638.1465 L167,648.1465 L177,648.1465 L167,638.1465 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="655.7148">S1</text><polygon fill="#181818" points="147,685.7676,157,689.7676,147,693.7676,151,689.7676" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58" x2="153" y1="689.7676" y2="689.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="65" y="685.0254">watch()</text><path d="M141,702.7676 L141,727.7676 L177,727.7676 L177,712.7676 L167,702.7676 L141,702.7676 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,702.7676 L167,712.7676 L177,712.7676 L167,702.7676 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="720.3359">E2</text><path d="M141,738.0781 L141,763.0781 L177,763.0781 L177,748.0781 L167,738.0781 L141,738.0781 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,738.0781 L167,748.0781 L177,748.0781 L167,738.0781 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="755.6465">S4</text><polygon fill="#181818" points="271,785.6992,281,789.6992,271,793.6992,275,789.6992" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="277" y1="789.6992" y2="789.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="166" y="784.957">watchConfig()</text><polygon fill="#181818" points="400,815.0098,410,819.0098,400,823.0098,404,819.0098" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="283" x2="406" y1="819.0098" y2="819.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="290" y="814.2676">watchConfig()</text><line style="stroke:#181818;stroke-width:1.0;" x1="412" x2="454" y1="833.0098" y2="833.0098"/><line style="stroke:#181818;stroke-width:1.0;" x1="454" x2="454" y1="833.0098" y2="846.0098"/><line style="stroke:#181818;stroke-width:1.0;" x1="413" x2="454" y1="846.0098" y2="846.0098"/><polygon fill="#181818" points="423,842.0098,413,846.0098,423,850.0098,419,846.0098" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="294,871.3203,284,875.3203,294,879.3203,290,875.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="288" x2="411" y1="875.3203" y2="875.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="300" y="870.5781">onData()</text><line style="stroke:#181818;stroke-width:1.0;" x1="283" x2="325" y1="904.6309" y2="904.6309"/><line style="stroke:#181818;stroke-width:1.0;" x1="325" x2="325" y1="904.6309" y2="917.6309"/><line style="stroke:#181818;stroke-width:1.0;" x1="284" x2="325" y1="917.6309" y2="917.6309"/><polygon fill="#181818" points="294,913.6309,284,917.6309,294,921.6309,290,917.6309" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="290" y="899.8887">sink.add()</text><polygon fill="#181818" points="170,942.9414,160,946.9414,170,950.9414,166,946.9414" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164" x2="282" y1="946.9414" y2="946.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="176" y="942.1992">onData()</text><path d="M141,959.9414 L141,984.9414 L177,984.9414 L177,969.9414 L167,959.9414 L141,959.9414 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,959.9414 L167,969.9414 L177,969.9414 L167,959.9414 " fill="#FFD700" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="977.5098">S5</text><polygon fill="#181818" points="170,1007.5625,160,1011.5625,170,1015.5625,166,1011.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="164" x2="282" y1="1011.5625" y2="1011.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="176" y="1006.8203">onError()</text><path d="M141,1024.5625 L141,1049.5625 L177,1049.5625 L177,1034.5625 L167,1024.5625 L141,1024.5625 " fill="#FFAAAA" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,1024.5625 L167,1034.5625 L177,1034.5625 L167,1024.5625 " fill="#FFAAAA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="1042.1309">S6</text><polygon fill="#181818" points="69,1056.873,59,1060.873,69,1064.873,65,1060.873" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="63" x2="158" y1="1060.873" y2="1060.873"/><polygon fill="#181818" points="147,1086.1836,157,1090.1836,147,1094.1836,151,1090.1836" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58" x2="153" y1="1090.1836" y2="1090.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="65" y="1085.4414">edit()</text><path d="M141,1103.1836 L141,1128.1836 L177,1128.1836 L177,1113.1836 L167,1103.1836 L141,1103.1836 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,1103.1836 L167,1113.1836 L177,1113.1836 L167,1103.1836 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="1120.752">E3</text><polygon fill="#181818" points="271,1150.8047,281,1154.8047,271,1158.8047,275,1154.8047" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="277" y1="1154.8047" y2="1154.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="166" y="1150.0625">edit()</text><polygon fill="#181818" points="400,1180.1152,410,1184.1152,400,1188.1152,404,1184.1152" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="283" x2="406" y1="1184.1152" y2="1184.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="290" y="1179.373">edit()</text><line style="stroke:#181818;stroke-width:1.0;" x1="412" x2="454" y1="1198.1152" y2="1198.1152"/><line style="stroke:#181818;stroke-width:1.0;" x1="454" x2="454" y1="1198.1152" y2="1211.1152"/><line style="stroke:#181818;stroke-width:1.0;" x1="413" x2="454" y1="1211.1152" y2="1211.1152"/><polygon fill="#181818" points="423,1207.1152,413,1211.1152,423,1215.1152,419,1211.1152" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="147,1236.4258,157,1240.4258,147,1244.4258,151,1240.4258" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58" x2="153" y1="1240.4258" y2="1240.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="65" y="1235.6836">tryConnect()</text><path d="M141,1253.4258 L141,1278.4258 L177,1278.4258 L177,1263.4258 L167,1253.4258 L141,1253.4258 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M167,1253.4258 L167,1263.4258 L177,1263.4258 L167,1253.4258 " fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15" x="147" y="1270.9941">E4</text><polygon fill="#181818" points="271,1301.0469,281,1305.0469,271,1309.0469,275,1305.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="159" x2="277" y1="1305.0469" y2="1305.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="166" y="1300.3047">tryConnect()</text><polygon fill="#181818" points="488.5,1330.3574,498.5,1334.3574,488.5,1338.3574,492.5,1334.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="283" x2="494.5" y1="1334.3574" y2="1334.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="290" y="1329.6152">GET /config</text><polygon fill="#181818" points="294,1344.3574,284,1348.3574,294,1352.3574,290,1348.3574" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="288" x2="504.5" y1="1348.3574" y2="1348.3574"/><polygon fill="#181818" points="400,1373.668,410,1377.668,400,1381.668,404,1377.668" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="283" x2="406" y1="1377.668" y2="1377.668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="290" y="1372.9258">edit()</text><line style="stroke:#181818;stroke-width:1.0;" x1="412" x2="454" y1="1391.668" y2="1391.668"/><line style="stroke:#181818;stroke-width:1.0;" x1="454" x2="454" y1="1391.668" y2="1404.668"/><line style="stroke:#181818;stroke-width:1.0;" x1="413" x2="454" y1="1404.668" y2="1404.668"/><polygon fill="#181818" points="423,1400.668,413,1404.668,423,1408.668,419,1404.668" style="stroke:#181818;stroke-width:1.0;"/><!--MD5=[17dbdf5c3d83213e90febcd7f3407565]
@startuml configs.sequence

box "Presentation" #90CAF9
participant Application as App
end box

box "Domain layer" #BBDEFB
participant ConfigBloc
end box

box "Data layer" #E3F2FD
participant ConfigsRepository
database "Local Storage" as LocalStorage
participant HassApi
end box

== On app launch ==
note over App : LauncherPage
note over ConfigBloc #gold: S1
App - -> ConfigBloc
note over ConfigBloc #LightGreen: E1
note over ConfigBloc #gold: S2
ConfigBloc - -> ConfigsRepository ++ : getLastConfig()
ConfigsRepository - -> LocalStorage ++ : box.get()
return Config
return Config
note over ConfigBloc #gold: S3
ConfigsRepository -> ConfigBloc : onError()
note over ConfigBloc #FFAAAA: S6
ConfigBloc - -> App
App -> App
== New or never connected config ==
note over App : FormPage
note over ConfigBloc #gold: S1
App - -> ConfigBloc : watch()
note over ConfigBloc #LightGreen: E2
note over ConfigBloc #gold: S4
ConfigBloc - -> ConfigsRepository : watchConfig()
ConfigsRepository - -> LocalStorage : watchConfig()
LocalStorage -> LocalStorage
LocalStorage -> ConfigsRepository : onData()
ConfigsRepository -> ConfigsRepository : sink.add()
ConfigsRepository -> ConfigBloc : onData()
note over ConfigBloc #gold: S5
ConfigsRepository -> ConfigBloc : onError()
note over ConfigBloc #FFAAAA: S6
ConfigBloc -> App
App - -> ConfigBloc : edit()
note over ConfigBloc #LightGreen: E3
ConfigBloc - -> ConfigsRepository : edit()
ConfigsRepository - -> LocalStorage : edit()
LocalStorage -> LocalStorage
App - -> ConfigBloc : tryConnect()
note over ConfigBloc #LightGreen: E4
ConfigBloc - -> ConfigsRepository : tryConnect()
ConfigsRepository - -> HassApi ++ : GET /config
return
ConfigsRepository - -> LocalStorage : edit()
LocalStorage -> LocalStorage


@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: fr
Country: FR
--></g></svg>